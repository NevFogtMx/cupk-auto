import{_ as L,r as u,u as N,a as l,o as i,c as d,b as n,w as _,d as E,E as s,e as I,F as B,f as T,g as f,p as z,h as F,i as g}from"./index-151888fb.js";const m=c=>(z("data-v-a410cb5a"),c=c(),F(),c),O={style:{margin:"22% auto"}},U=m(()=>g("br",null,null,-1)),q=m(()=>g("br",null,null,-1)),J={key:0,class:"captcha"},M=m(()=>g("br",null,null,-1)),P={__name:"Login",setup(c){const t=u(1),v=N(),h=u({}),r=u(""),p=u(""),b=[{value:1,label:"教务系统"},{value:2,label:"融合门户"}];function y(a){a==2&&fetch("http://localhost:8877/rhmh/login/getCaptcha").then(e=>e.json()).then(e=>{h.value=e.data,r.value=e.data.captcha}).catch(e=>{console.log(e)})}function C(){fetch("http://localhost:8877/rhmh/login/changeCaptcha").then(a=>a.json()).then(a=>{a.code==1?r.value=a.data.captcha:s.error("验证码刷新失败")}).catch(a=>{console.log(a)})}function k(){const a=I.service({lock:!0,text:"登录中...",background:"rgba(0, 0, 0, 0.7)"});t.value===1?fetch("http://localhost:8877/jwxt/login").then(e=>e.json()).then(e=>{a.close(),e.code===1?(s({message:"登录成功",type:"success"}),v.push({path:"/sis/home/qk"})):s.error(e.msg)}).catch(e=>{console.log(e)}):t.value===2&&(h.value.captcha=p.value,fetch("http://localhost:8877/rhmh/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h.value)}).then(e=>e.json()).then(e=>{a.close(),e.code===1?(s({message:"登录成功",type:"success"}),v.push({path:"/fp/home/main"})):s.error(e.msg)}).catch(e=>{console.log(e)}))}return(a,e)=>{const V=l("el-option"),x=l("el-select"),j=l("el-image"),w=l("el-input"),S=l("el-button");return i(),d("div",O,[n(x,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value=o),class:"m-2",placeholder:"Select",size:"large",onChange:y},{default:_(()=>[(i(),d(B,null,T(b,o=>n(V,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),U,q,t.value==2?(i(),d("div",J,[n(j,{src:r.value,fit:"scale-down",title:"验证码",onClick:C},{error:_(()=>[f(" loading... ")]),_:1},8,["src"]),n(w,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),placeholder:"输入验证码",class:"w-100",clearable:""},null,8,["modelValue"])])):E("",!0),M,n(S,{class:"login-btn",type:"primary",size:"large",round:"",onClick:k},{default:_(()=>[f("登录")]),_:1})])}}},A=L(P,[["__scopeId","data-v-a410cb5a"]]);export{A as default};
